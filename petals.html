<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Petals</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="https://d3js.org/d3.v7.min.js"></script>
        <link rel="apple-touch-icon" href="/apple-touch-icon.png">
        <!-- Place favicon.ico in the root directory -->

    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">
            You are using an <strong>outdated</strong> browser. Please
            <a href="http://browsehappy.com/">upgrade your browser</a> to improve
            your experience.
            </p>
        <![endif]-->

        <input type="file" id="file-selector" accept=".json">
        <div id="main">

        </div>



    </body>

    <script type="text/javascript">
     const petalPath = `M 0,0
                     C 50,50 22,70 23,100
                     C 07,82 05,80 00,80
                     C -5,80 -7,82 -23,100
                     C -22,70, -50,50, 0,0`

     const containerHTML = `
         <svg id="container" width=500 height=100 style='border: 1px dashed'>
             <path d='${petalPath}' transform='translate(50, 0)' />
             <path d='${petalPath}' transform='translate(150, 0)' />
             <path d='${petalPath}' transform='translate(250, 0)' />
             <path d='${petalPath}' transform='translate(350, 0)' />
             <path d='${petalPath}' transform='translate(450, 0)' />
        </svg>
     `
     document.getElementById('main').innerHTML = containerHTML

     const colourDict = {
         Action: "#ffc8f0",
         Comedy: "#cbf2bd",
         Animation: "#afe9ff",
         Drama: "#ffb09e",
         Other: "#fff2b4"
     }

     const fileSelector = document.getElementById('file-selector')
     fileSelector.addEventListener('change', (event) => {
         const file = event.target.files[0]
         const reader = new FileReader()
         reader.addEventListener('load', e => {
             const movies = JSON.parse(e.target.result)
             const fiveMov = movies.slice(0,5)
             const selected = d3.select('#container')
                                .selectAll('path')
                                .data(movies)
                                .attr('fill', d => colourDict[d.genres[0]] || colourDict.Other)
                                .attr('fill-opacity', 0.5)
                                .attr('stroke-width', 2)
                                .attr('stroke', d => colourDict[d.genres[0]] || colorDict.Other)

             console.log(selected)
         })
         reader.readAsText(file)
     })


    </script>


</html>
